(()=>{"use strict";const e=[[{key:{ru:"ё",en:"`"},shift:{ru:"Ё",en:"~"},code:"Backquote"},{key:{ru:"1",en:"1"},shift:{ru:"!",en:"!"},code:"Digit1"},{key:{ru:"2",en:"2"},shift:{ru:'"',en:"@"},code:"Digit2"},{key:{ru:"3",en:"3"},shift:{ru:"№",en:"#"},code:"Digit3"},{key:{ru:"4",en:"4"},shift:{ru:";",en:"$"},code:"Digit4"},{key:{ru:"5",en:"5"},shift:{ru:"%",en:"%"},code:"Digit5"},{key:{ru:"6",en:"6"},shift:{ru:":",en:"^"},code:"Digit6"},{key:{ru:"7",en:"7"},shift:{ru:"?",en:"&"},code:"Digit7"},{key:{ru:"8",en:"8"},shift:{ru:"*",en:"*"},code:"Digit8"},{key:{ru:"9",en:"9"},shift:{ru:"(",en:"("},code:"Digit9"},{key:{ru:"0",en:"0"},shift:{ru:")",en:")"},code:"Digit0"},{key:{ru:"-",en:"-"},shift:{ru:"_",en:"_"},code:"Minus"},{key:{ru:"=",en:"="},shift:{ru:"+",en:"+"},code:"Equal"},{key:"Backspace",code:"Backspace",class:"key_backspace",noType:!0}],[{key:"Tab",code:"Tab",class:"key_tab",noType:!0},{key:{ru:"й",en:"q"},shift:{ru:"Й",en:"Q"},code:"KeyQ"},{key:{ru:"ц",en:"w"},shift:{ru:"Ц",en:"W"},code:"KeyW"},{key:{ru:"у",en:"e"},shift:{ru:"У",en:"E"},code:"KeyE"},{key:{ru:"к",en:"r"},shift:{ru:"К",en:"R"},code:"KeyR"},{key:{ru:"е",en:"t"},shift:{ru:"Е",en:"T"},code:"KeyT"},{key:{ru:"н",en:"y"},shift:{ru:"Н",en:"Y"},code:"KeyY"},{key:{ru:"г",en:"u"},shift:{ru:"Г",en:"U"},code:"KeyU"},{key:{ru:"ш",en:"i"},shift:{ru:"Ш",en:"I"},code:"KeyI"},{key:{ru:"щ",en:"o"},shift:{ru:"Щ",en:"O"},code:"KeyO"},{key:{ru:"з",en:"p"},shift:{ru:"З",en:"P"},code:"KeyP"},{key:{ru:"х",en:"["},shift:{ru:"Х",en:"{"},code:"BracketLeft"},{key:{ru:"ъ",en:"]"},shift:{ru:"Ъ",en:"}"},code:"BracketRight"},{key:{ru:"\\",en:"\\"},shift:{ru:"|",en:"|"},code:"Backslash",class:"key_backslash"},{key:"Del",code:"Delete",class:"key_del",noType:!0}],[{key:"CapsLock",code:"CapsLock",class:"key_capslock",noType:!0},{key:{ru:"ф",en:"a"},shift:{ru:"Ф",en:"A"},code:"KeyA"},{key:{ru:"ы",en:"s"},shift:{ru:"Ы",en:"S"},code:"KeyS"},{key:{ru:"в",en:"d"},shift:{ru:"В",en:"D"},code:"KeyD"},{key:{ru:"а",en:"f"},shift:{ru:"А",en:"F"},code:"KeyF"},{key:{ru:"п",en:"g"},shift:{ru:"П",en:"G"},code:"KeyG"},{key:{ru:"р",en:"h"},shift:{ru:"Р",en:"H"},code:"KeyH"},{key:{ru:"о",en:"j"},shift:{ru:"О",en:"J"},code:"KeyJ"},{key:{ru:"л",en:"k"},shift:{ru:"Л",en:"K"},code:"KeyK"},{key:{ru:"д",en:"l"},shift:{ru:"Д",en:"L"},code:"KeyL"},{key:{ru:"ж",en:";"},shift:{ru:"Ж",en:":"},code:"Semicolon"},{key:{ru:"э",en:"'"},shift:{ru:"Э",en:'"'},code:"Quote"},{key:"Enter",code:"Enter",class:"key_enter",noType:!0}],[{key:"Shift",code:"ShiftLeft",class:"key_leftshift",noType:!0},{key:{ru:"я",en:"z"},shift:{ru:"Я",en:"Z"},code:"KeyZ"},{key:{ru:"ч",en:"x"},shift:{ru:"Ч",en:"X"},code:"KeyX"},{key:{ru:"с",en:"c"},shift:{ru:"С",en:"C"},code:"KeyC"},{key:{ru:"м",en:"v"},shift:{ru:"М",en:"V"},code:"KeyV"},{key:{ru:"и",en:"b"},shift:{ru:"И",en:"B"},code:"KeyB"},{key:{ru:"т",en:"n"},shift:{ru:"Т",en:"N"},code:"KeyN"},{key:{ru:"ь",en:"m"},shift:{ru:"Ь",en:"M"},code:"KeyM"},{key:{ru:"б",en:","},shift:{ru:"Б",en:"<"},code:"Comma"},{key:{ru:"ю",en:"."},shift:{ru:"Ю",en:">"},code:"Period"},{key:{ru:".",en:"/"},shift:{ru:",",en:"?"},code:"Slash"},{key:"&uarr;",code:"ArrowUp",class:"key-arrow",noType:!0},{key:"Shift",code:"ShiftRight",class:"key_rightshift",noType:!0}],[{key:"Ctrl",code:"ControlLeft",class:"key_leftctrl",noType:!0},{key:"Alt",code:"AltLeft",class:"key_leftalt",noType:!0},{key:" ",code:"Space",class:"key_space"},{key:"Alt",code:"AltRight",class:"key_rightalt",noType:!0},{key:"&larr;",code:"ArrowLeft",class:"key-arrow",noType:!0},{key:"&darr;",code:"ArrowDown",class:"key-arrow",noType:!0},{key:"&rarr;",code:"ArrowRight",class:"key-arrow",noType:!0},{key:"Ctrl",code:"ControlRight",class:"key_rightctrl",noType:!0}]],t=(e,t,...n)=>{const a=document.createElement(e);return a.classList.add(...n),a.innerHTML=t,a},{body:n}=document,a=t("textarea","","terminal"),s=new class{constructor(){this.theme="dark",this.lang="en",this.caps="off",this.shift=!1}getTheme(){localStorage.getItem("theme")?this.theme=localStorage.getItem("theme"):localStorage.setItem("theme",this.theme)}changeTheme(e){"dark"===this.theme?(this.theme="light",document.documentElement.classList.add("light"),document.documentElement.classList.remove("dark")):(this.theme="dark",document.documentElement.classList.add("dark"),document.documentElement.classList.remove("light")),localStorage.setItem("theme",this.theme)}getLanguage(){localStorage.getItem("lang")?this.lang=localStorage.getItem("lang"):localStorage.setItem("lang",this.lang)}changeLanguage(e){"en"===this.lang?this.lang="ru":this.lang="en",localStorage.setItem("lang",this.lang),this.updateKeyboard(e)}changeCapsLock(e){"on"===this.caps?this.caps="off":this.caps="on",this.updateKeyboard(e)}updateKeyboard(e){const{lang:t}=this;e.shiftKey||this.shift?document.querySelectorAll(".key").forEach((e=>{e.dataset[`${t}Shift`]?"on"===this.caps?e.innerHTML=e.dataset[`${t}Shift`].toLowerCase():e.innerHTML=e.dataset[`${t}Shift`]:e.dataset[t]&&(e.innerHTML=e.dataset[t])})):document.querySelectorAll(".key").forEach((n=>{n.dataset[t]&&("on"!==this.caps||e.shiftKey||this.shift?n.innerHTML=n.dataset[t]:n.innerHTML=n.dataset[t].toUpperCase())}))}deleteShift(e){this.shift&&(this.shift=!this.shift,document.querySelector(".key_leftshift").classList.remove("active"),document.querySelector(".key_rightshift").classList.remove("active"),this.updateKeyboard(e))}generateKeyboard(){const n=t("div","","keyboard__container"),a=t("div","","keyboard");this.getLanguage();for(let n=0;n<e.length;n+=1){const s=t("div","","row");e[n].forEach((e=>{const n=e.key.ru&&e.key.en?e.key[this.lang]:e.key,a=t("div",n,"key");e.class&&a.classList.add(e.class),a.dataset.code=e.code,e.key.ru&&e.key.en&&(a.dataset.ru=e.key.ru,a.dataset.en=e.key.en),e.shift&&(a.dataset.ruShift=e.shift.ru,a.dataset.enShift=e.shift.en),e.noType&&(a.dataset.noType=!0),s.append(a)})),a.append(s)}return n.append(a),n}},o=(e,t,n)=>{let o="",r=a.selectionStart;if(e.preventDefault(),a.focus(),"CapsLock"===n&&s.changeCapsLock(e),"Theme"===n&&s.changeTheme(e),("AltLeft"===n&&(e.shiftKey||s.shift)||"AltRight"===n&&(e.shiftKey||s.shift)||"ShiftLeft"===n&&e.altKey||"ShiftRight"===n&&e.altKey||"Language"===n)&&(s.changeLanguage(e),s.deleteShift(e)),"ShiftLeft"!==n&&"ShiftRight"!==n||s.updateKeyboard(e),"ArrowLeft"===n&&r>0&&a.setSelectionRange(r-1,r-1),"ArrowRight"===n&&(r=a.selectionEnd,a.setSelectionRange(r+1,r+1)),"ArrowUp"===n){const e=a.value.substring(0,r).split("\n");1===e.length||e[e.length-1].length>=57?r-=57:e[e.length-1].length<=e[e.length-2].length%57?r-=e[e.length-2].length%57+1:r-=e[e.length-1].length+1,r<0&&(r=0),a.setSelectionRange(r,r)}if("ArrowDown"===n){r=a.selectionEnd;const e=a.value.substring(0,r).split("\n"),t=a.value.substring(a.selectionEnd).split("\n");1===t.length||t[0].length>=57?r+=57:e[e.length-1].length%57>t[1].length?r+=t[0].length+t[1].length+1:e[e.length-1].length+t[0].length>57?r+=t[0].length:r+=e[e.length-1].length%57+t[0].length+1,a.setSelectionRange(r,r)}if("Tab"===n&&(o="    "),"Enter"===n&&(o="\n"),"Backspace"===n&&(o="-1"),"Delete"===n&&(o="+1"),t.dataset.noType||(o=t.textContent,s.deleteShift(e)),o){let e=a.value.substring(0,r),t=a.value.substring(a.selectionEnd);"-1"===o&&(o="",r===a.selectionEnd?(e=e.slice(0,-1),r-=r>0?2:1):r-=1),"+1"===o&&(o="",r===a.selectionEnd&&(t=t.slice(1)),r-=1),a.value=e+o+t,a.setSelectionRange(r+1,r+1),"    "===o&&a.setSelectionRange(r+4,r+4)}};window.onload=()=>{if((()=>{const e=t("header","","header"),a=t("div","","container");e.append(a),a.append(t("h1","Virtual Keyboard","b-h1")),n.append(e)})(),(()=>{const e=t("main","","main"),o=t("div","","container");e.append(o),o.append((()=>{const e=document.createElement("div");return e.classList.add("keyboard__head"),e.innerHTML='\n    <div class="key key_theme btn-theme" data-code="Theme" data-light="light" data-dark="dark" data-no-type="true">dark</div>\n    <div class="key key_lang btn-key" data-code="Language" data-ru="ru" data-en="en" data-no-type="true">en</div>\n  ',e})()),o.append(a),o.append(s.generateKeyboard()),n.append(e)})(),(()=>{const e=t("footer","","footer"),a=t("div","","container");e.append(a),a.append(t("p","Vasyl Makohin, &copy; 2022","copyright")),n.append(e)})(),s.getTheme(),s.getLanguage(),localStorage.getItem("lang")){let e=localStorage.getItem("lang");document.querySelector(".btn-key").innerHTML=e}document.addEventListener("keydown",(e=>{const t=document.querySelector(`[data-code=${e.code}]`);t&&(t.classList.add("active"),o(e,t,e.code))})),document.addEventListener("keyup",(e=>{const t=document.querySelector(`[data-code=${e.code}]`);t&&(t.classList.remove("active"),"ShiftLeft"!==e.code&&"ShiftRight"!==e.code||(s.deleteShift(e),s.updateKeyboard(e)))})),document.querySelector(".keyboard").addEventListener("click",(e=>{if(e.target.closest(".key")){const t=e.target.closest(".key");"ShiftLeft"!==t.dataset.code&&"ShiftRight"!==t.dataset.code||(s.shift=!s.shift,t.classList.toggle("active")),o(e,t,t.dataset.code)}})),document.querySelector(".keyboard__head").addEventListener("click",(e=>{if(e.target.closest(".key")){const t=e.target.closest(".key");o(e,t,t.dataset.code)}}))}})();